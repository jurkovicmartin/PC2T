package ProjectFilms;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

public class DBControl {
	
	public static void CreateDatabase() {
		Connection conn = DBConnection.getDBConnection();

        try (Statement stmt = conn.createStatement()){
        	
            String create = "CREATE TABLE featurefilms " +
                         "(name VARCHAR(50) PRIMARY KEY, " +
                         " director VARCHAR(50), " +
                         " year INTEGER, " + 
                         " actors VARCHAR(100), " +
                         " ratings VARCHAR(200))";
            stmt.executeUpdate(create);

            create = "CREATE TABLE animatedfilms " +
                    "(name VARCHAR(50) PRIMARY KEY, " +
                    " director VARCHAR(50), " +
                    " year INTEGER, " + 
                    " age INTEGER, " +
                    " animators VARCHAR(100), " +
                    " ratings VARCHAR(200))";

            stmt.executeUpdate(create);
            
        } catch (Exception e) {
        	e.printStackTrace();
        }
    }
	
	public static void insertFilms() {
		List<Films> featureFilms = new ArrayList<Films>();
		List<Films> animatedFilms = new ArrayList<Films>();
		Connection conn = DBConnection.getDBConnection();
		
		for(Films film : Films.Films) {
			if(film instanceof FeatureFilm)
				featureFilms.add(film);
			else if(film instanceof AnimatedFilm)
				animatedFilms.add(film);
		}
		
		String insertFeature = "INSERT INTO featurefilms " + "(name, director , year, actors, ratings)" + "VALUES(?,?,?,?,?)";
		for(Films featurefilm : featureFilms) {
				try (PreparedStatement prStmt = conn.prepareStatement(insertFeature)) {
				      prStmt.setString(1, featurefilm.getName());
				      prStmt.setString(2, featurefilm.getDirector());
				      prStmt.setInt(3, featurefilm.getYear());

				      prStmt.executeUpdate();
				    } 
				catch (SQLException e) {
				      e.printStackTrace();
				    }
				finally {
					DBConnection.closeConnection();;
				}
		}
		String insert = "INSERT INTO animatedfilms " + "(name, director , year, age, animators, ratings)" + "VALUES(?,?,?,?,?,?)";
	
	  }
	
	public static void deleteFilms() {
		Connection conn = DBConnection.getDBConnection();
		String delete = "DELETE FROM featurefilms";
		
		try (Statement stmt = conn.createStatement()){
			stmt.executeUpdate(delete);
		} catch (SQLException e) {
			e.printStackTrace();
		}
		
	}
}
